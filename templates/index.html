{% extends "base.html" %}
{% block title %}AI Legal Tracker &mdash; Latest{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero">
    <div class="hero-content">
        <h2 class="hero-title">AI + Law News</h2>
        <p class="hero-subtitle">Your daily digest of {{ total_articles }} articles from {{ source_count }} trusted sources, organized across {{ categories|length }} categories.</p>
    </div>
    <div class="hero-categories">
        {% for key, cat in categories.items() %}
        {% if category_counts.get(key) %}
        <a href="{{ base_url }}/category/{{ key }}.html" class="hero-cat-chip chip-{{ key }}">
            {{ cat.label }}
            <span class="chip-count">{{ category_counts[key] }}</span>
        </a>
        {% endif %}
        {% endfor %}
    </div>
</section>

<!-- Featured Article (first article, larger card) -->
{% if date_groups %}
{% set first_articles = date_groups[0][1] %}
{% if first_articles %}
<section class="featured-section">
    <div class="section-label">
        <span class="label-dot"></span>
        Latest
    </div>
    <article class="featured-card">
        <div class="featured-meta">
            <span class="tag tag-{{ first_articles[0].category }}">
                {{ categories.get(first_articles[0].category, {}).get('label', first_articles[0].category) }}
            </span>
            <span class="featured-source">{{ first_articles[0].source }}</span>
            <span class="featured-date">{{ first_articles[0].published_str }}</span>
        </div>
        <h3 class="featured-title">
            <a href="{{ first_articles[0].link }}" target="_blank" rel="noopener noreferrer">
                {{ first_articles[0].title }}
            </a>
        </h3>
        <p class="featured-summary">{{ first_articles[0].summary }}</p>
    </article>
</section>
{% endif %}
{% endif %}

<!-- Article Feed -->
{% set skip_first = [true] %}
{% for date_str, articles in date_groups %}
<section class="date-group">
    <div class="date-heading">
        <div class="date-heading-left">
            <span class="date-icon">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
            </span>
            <h3>{{ date_str }}</h3>
        </div>
        <span class="date-count">{{ articles|length }} article{{ 's' if articles|length != 1 else '' }}</span>
    </div>
    <div class="article-grid">
        {% for article in articles %}
        {% if skip_first[0] and loop.first %}
            {% if skip_first.append(false) %}{% endif %}
        {% else %}
        <article class="article-card">
            <div class="article-meta">
                <span class="tag tag-sm tag-{{ article.category }}">
                    {{ categories.get(article.category, {}).get('label', article.category) }}
                </span>
                <span class="article-source">{{ article.source }}</span>
            </div>
            <h4 class="article-title">
                <a href="{{ article.link }}" target="_blank" rel="noopener noreferrer">
                    {{ article.title }}
                </a>
            </h4>
            <p class="article-summary">{{ article.summary }}</p>
            <div class="article-footer">
                <span class="article-date">{{ article.published_str }}</span>
                <a href="{{ article.link }}" target="_blank" rel="noopener noreferrer" class="read-more">
                    Read article
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                </a>
            </div>
        </article>
        {% endif %}
        {% endfor %}
    </div>
</section>
{% endfor %}

{% if not date_groups %}
<section class="empty-state">
    <div class="empty-icon">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M4 22h16a2 2 0 002-2V4a2 2 0 00-2-2H8l-4 4v14a2 2 0 002 2z"/><line x1="10" y1="9" x2="18" y2="9"/><line x1="10" y1="13" x2="18" y2="13"/><line x1="10" y1="17" x2="14" y2="17"/></svg>
    </div>
    <h3>No articles found</h3>
    <p>Check back soon &mdash; feeds are updated daily at 06:17 UTC.</p>
</section>
{% endif %}
{% endblock %}
